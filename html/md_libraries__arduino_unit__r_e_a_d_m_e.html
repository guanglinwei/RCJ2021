<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Spongebot Robocup Junior Soccer 2021: ArduinoUnit</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Spongebot Robocup Junior Soccer 2021
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ArduinoUnit </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>ArduinoUnit is a testing framework for Arduino projects. It supports Arduino, ESP8266 and ESP32 as well as "en vitro" development system (vs embedded target) testing.</p>
<h1><a class="anchor" id="autotoc_md71"></a>
Getting Started</h1>
<p>Install the library from the Arduino IDE. From the menu, navigate:</p>
<ul>
<li>Sketch-&gt;Include Library-&gt;Manage Libraries...</li>
<li>Search for "arduinounit"</li>
<li>Install</li>
</ul>
<p>After this, examples should be available from File-&gt;Examples in the "Examples from Custom Libraries" section.</p>
<p>Here is a simple unit testing sketch:</p>
<div class="fragment"><div class="line">#line 2 &quot;sketch.ino&quot;</div>
<div class="line">#include &lt;ArduinoUnit.h&gt;</div>
<div class="line"> </div>
<div class="line">test(ok) </div>
<div class="line">{</div>
<div class="line">  int x=3;</div>
<div class="line">  int y=3;</div>
<div class="line">  assertEqual(x,y);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">test(bad)</div>
<div class="line">{</div>
<div class="line">  int x=3;</div>
<div class="line">  int y=3;</div>
<div class="line">  assertNotEqual(x,y);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">void setup()</div>
<div class="line">{</div>
<div class="line">  Serial.begin(9600);</div>
<div class="line">  while(!Serial) {} // Portability for Leonardo/Micro</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">void loop()</div>
<div class="line">{</div>
<div class="line">  Test::run();</div>
<div class="line">}</div>
</div><!-- fragment --><p>Upload this sketch to the Arduino (using the 'Upload' button, <code>File | Upload</code> or <code>Ctrl+U</code>).</p>
<p>Turn on the Serial Monitor (using the 'Serial Monitor' button, <code>Tools | Serial Monitor</code> or <code>Ctrl+Shift+M</code>) and expect to see the following:</p>
<div class="fragment"><div class="line">Assertion failed: (x=3) != (y=3), file sketch.ino, line 17.</div>
<div class="line">Test bad failed.</div>
<div class="line">Test ok passed.</div>
<div class="line">Test summary: 1 passed, 1 failed, and 0 skipped, out of 2 test(s).</div>
</div><!-- fragment --><p>The following asserts are supported [with an optional footnote and return value]</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Assertion   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#ae8e6d12a4e06720b114bf6ad446e646b">assertEqual(a,b [,footnote [,retval]])</a></code>   </td><td class="markdownTableBodyNone"><code>a == b</code>?    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>assertNear(a,b,maxerr, [,footnote[,retval]])</code>   </td><td class="markdownTableBodyNone"><code>abs(b-a)&lt;=maxerr</code>?    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>assertRelativelyNear(a,b,maxerr, [,footnote[,retval]])</code>   </td><td class="markdownTableBodyNone"><code>abs(b-a)/abs(Â½(abs(a)+abs(b)))&lt;=maxerr</code>?    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#a6ecbfc78de47f24aadcd7beab36df809">assertNotEqual(a,b [,footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone"><code>a != b</code>?    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#a4e217c9170c1f55ecc10d6477fba7fe7">assertLess(a,b [,footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone"><code>a &lt; b</code>?    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#ae88cd4488c7de1249fb4f98d60a27476">assertLessOrEqual(a,b [,footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone"><code>a &lt;= b</code>?    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#afeacd0028af8f8fd2e4f32102e4d1e61">assertMore(a,b [,footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone"><code>a &gt; b</code>?    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#a2ca6d57a06d4a9990ed3e1c60a175cea">assertMoreOrEqual(a,b [,footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone"><code>a &gt;= b</code>?    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#aea51ec1d4ca67860775682b47fa2af88">assertTrue(p [,footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone">same as <code><a class="el" href="_arduino_unit_8h.html#ae8e6d12a4e06720b114bf6ad446e646b">assertEqual(p,true)</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#a5eb72fc7e955672e419132d92722e446">assertFalse(p [,footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone">same as <code><a class="el" href="_arduino_unit_8h.html#ae8e6d12a4e06720b114bf6ad446e646b">assertEqual(p,false)</a></code>   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md72"></a>
[,footnote[,retval]]</h1>
<p>Assertions are replaced with essentially (retval is the optional last value of an assert): </p><pre class="fragment">if (not assertion) { fail(); return [retval]; }
</pre><p> When things go wrong, it can be useful to print additional information. As of 2.3.2-alpha, this is possible with any assertXXX() method by adding an additional third parameter [footnote] to the assert. For example, </p><div class="fragment"><div class="line">test(cases)</div>
<div class="line">{</div>
<div class="line">  int x=3;</div>
<div class="line">  for (int k=0; k&lt;4; ++k) {</div>
<div class="line">    assertNotEqual(x,k,&quot;case k=&quot; &lt;&lt; k);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p> will fail with the message </p><div class="fragment"><div class="line">Assertion failed: (x=3) != (k=3), file basic.ino, line 20 [case k=3].</div>
</div><!-- fragment --><p> The additional message is only created if the assert actually needs to generate output (usually when it fails). It appears in the [] brackets at the end of the assert message. Notice you can create fairly complex messages by chaining things you can print (like <code>Serial.print()</code>) between <code>&lt;&lt;</code> operators. This is similar to the C++ ostream insertion operators, if you are familar with that.</p>
<p>The status of the test can be used (bool ok) when printing the message. Under normal verbosity settings, ok will always be false, but more verbose settings can print assert messages even if they pass.</p>
<h1><a class="anchor" id="autotoc_md73"></a>
Selecting tests</h1>
<p>In your setup() function, you can select which tests are going to be setup and looped. The default is that all tests are included.</p>
<p><code><a class="el" href="class_test.html#a00269bd7c55b1c93477be06174280b04">Test::exclude(const char *pattern)</a></code> removes all the tests that match the given *-pattern.</p>
<p><code><a class="el" href="class_test.html#acfe763aab53dbecab02f473b93536347">Test::include(const char *pattern)</a></code> includes all the tests that match the given *-pattern.</p>
<p>Here are some examples:</p>
<h1><a class="anchor" id="autotoc_md74"></a>
Select examples:</h1>
<p>A single test <code>my_test</code></p>
<div class="fragment"><div class="line">void setup()</div>
<div class="line">{</div>
<div class="line">  Serial.begin(9600);</div>
<div class="line">  while(!Serial) {} // Portability for Leonardo/Micro</div>
<div class="line">  Test::exclude(&quot;*&quot;);</div>
<div class="line">  Test::include(&quot;my_test&quot;);</div>
<div class="line">}</div>
</div><!-- fragment --><p>All tests named dev_-something, but not the ones ending in _skip or _slow, or have the word eeprom in them: </p><div class="fragment"><div class="line">void setup()</div>
<div class="line">{</div>
<div class="line">  Serial.begin(9600);</div>
<div class="line">  while(!Serial) {} // Portability for Leonardo/Micro</div>
<div class="line">  Test::exclude(&quot;*&quot;);</div>
<div class="line">  Test::include(&quot;dev_*&quot;);</div>
<div class="line">  Test::exclude(&quot;*_slow&quot;);</div>
<div class="line">  Test::exclude(&quot;*_skip&quot;);</div>
<div class="line">  Test::exclude(&quot;*eeprom*&quot;);</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md75"></a>
Output</h1>
<p>The <code><a class="el" href="class_test.html#a33e59751992ec1a8a65745c0b6b144b0">Test::out</a></code> value is the <em>shared</em> value for all tests describing where output for all tests goes. The default is</p>
<div class="fragment"><div class="line">Test::out = &amp;Serial;</div>
</div><!-- fragment --><p>But you can set to the address of any <a class="el" href="class_print.html">Print</a> stream. For example, if you want the output to be on the <code>Serial3</code> device on the arduino mega, use</p>
<div class="fragment"><div class="line">Test::out = &amp;Serial3;</div>
</div><!-- fragment --><p>in your <code>setup()</code>. Note the library does not set the baud rate - you have to do that in your <code>setup()</code>.</p>
<h2><a class="anchor" id="autotoc_md76"></a>
Verbosity</h2>
<p>Normal ArduinoUnit verbosity reports only failed assertions, the status (pass,skip,fail) of completed tests, and a summary.</p>
<h3><a class="anchor" id="autotoc_md77"></a>
Seeing more.</h3>
<p>It is often useful to see the results of assertions [and footnotes] even when they pass. If you want to trace everything in this way, you can turn on all output with <code><a class="el" href="class_test.html#a1ff0e4cf27254c988233880fff9e6c6d">Test::min_verbosity</a> = TEST_VERBOSITY_ALL</code> in your setup.</p>
<h3><a class="anchor" id="autotoc_md78"></a>
Seeing less more.</h3>
<p>The previous choice is great until you are lost in an ocean of messages for tests you do not want to watch at the moment. Instead of globally setting <code>min_verbosity/max_verbosity</code> in your <code>setup()</code>, you can instead use <code>verbosity = TEST_VERBOSITY_ALL</code> in a given test to see everything about that test.</p>
<h2><a class="anchor" id="autotoc_md79"></a>
MockPrint and MockStream (intermediate)</h2>
<p><code><a class="el" href="struct_mock_print.html">MockPrint</a></code> is provided by ArduinoUnit to mimic a real output device, like Serial, but is also a <a class="el" href="class_string.html">String</a> which happens to contain the information printed to it. This can be used to test output formatting, as in: </p><div class="fragment"><div class="line">void format(Print &amp;out, int value) {</div>
<div class="line">  out.print(&quot;decimal &quot;);</div>
<div class="line">  out.print(value);</div>
<div class="line">  out.print(&quot; is hex &quot;);</div>
<div class="line">  out.println(value,HEX);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">test(format) {</div>
<div class="line">  MockPrint mp;</div>
<div class="line">  format(mp,32); // test as mock</div>
<div class="line">  assertEqual(mp,&quot;decimal 32 is hex 20\r\n&quot;);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">void setup() {</div>
<div class="line">  Serial.begin();</div>
<div class="line">  while (!Serial) {}</div>
<div class="line">  format(Serial,100); // format to serial</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">void loop() {</div>
<div class="line">  Test::run();</div>
<div class="line">}</div>
</div><!-- fragment --><p><code><a class="el" href="struct_mock_stream.html">MockStream</a></code> is provided by ArduinoUnit to mimic a real input/output device, like Serial. It contains two <code><a class="el" href="struct_mock_print.html">MockPrint</a></code> parts, <code>input</code> contains the input that will be read from the <a class="el" href="struct_mock_stream.html">MockStream</a>, and <code>output</code> which contains the output that was written. This can be used to test input and output, as in: </p><div class="fragment"><div class="line">void square(Stream &amp;io) {</div>
<div class="line">  io.print(&quot;value? &quot;);</div>
<div class="line">  int x = io.parseInt();</div>
<div class="line">  out.print(value);  </div>
<div class="line">  out.print(&quot;*&quot;);</div>
<div class="line">  out.print(value);</div>
<div class="line">  out.print(&quot;=&quot;);</div>
<div class="line">  out.println(x*x);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">test(square) {</div>
<div class="line">  MockStream ms;</div>
<div class="line">  ms.input.print(10);</div>
<div class="line">  square(ms);</div>
<div class="line">  assertEqual(ms.output,&quot;value? 10*10=100\r\n&quot;);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">void setup() {</div>
<div class="line">  Serial.begin();</div>
<div class="line">  while (!Serial) {}</div>
<div class="line">  square(Serial); // format to serial</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">void loop() {</div>
<div class="line">  Test::run();</div>
<div class="line">}</div>
</div><!-- fragment --><p> The <code>mockstream</code> example shows a convenient way to switch between real and mock streams for testing.</p>
<h2><a class="anchor" id="autotoc_md80"></a>
En Vitro Testing (advanced)</h2>
<p>ArduinoUnit will compile in a standard C++ environment (LLVM or GCC) with -std=gnu++11. The advanced example has a makefile and main.cpp to support this.</p>
<p>Note ArduinoUnit has very limited mocking features; you will have to include the mocking features you need to simulate the embedded environment. The main.cpp file in the advanced example illustrates minimal mocking. In particular the only features provided (because of dependencies on these by ArduinoUnit) are: </p><div class="fragment"><div class="line">F()</div>
<div class="line">millis()</div>
<div class="line">micros()</div>
<div class="line">String</div>
<div class="line">Print</div>
<div class="line">Printable</div>
<div class="line">Stream # public components only</div>
</div><!-- fragment --><p> These are available via <code>#include "ArduinoUnitMock.h"</code>. In the mock environment, there are two additional objects, <code><a class="el" href="struct_cpp_stream_print.html">CppStreamPrint</a></code> and <code><a class="el" href="struct_cpp_i_o_stream.html">CppIOStream</a></code>, which wrap C++ <code>std::ostream</code> (and <code>std::istream</code> for <code><a class="el" href="struct_cpp_i_o_stream.html">CppIOStream</a></code>). This simplifies creating tests in the mocking environments. Look at the advanced example and test firmware for guidance.</p>
<h2><a class="anchor" id="autotoc_md81"></a>
Verbosity (advanced)</h2>
<p>Just how much information is generated on each test is fairly flexible, and designed to address these rules:</p>
<ol type="1">
<li>How much code is generated (TEST_MAX_VERBOSITY)</li>
</ol>
<ol type="1">
<li>Global maximums subject to 1 (static <a class="el" href="class_test.html#aad3dc21628f5210b9ebdf843eb2b2ae0">Test::max_verbosity</a>)</li>
</ol>
<ol type="1">
<li>Global minimums subject to 1 and 2 (static <a class="el" href="class_test.html#a1ff0e4cf27254c988233880fff9e6c6d">Test::min_verbosity</a>)</li>
</ol>
<ol type="1">
<li>Per-test requirements subject to 1, 2 and 3 (<a class="el" href="class_test.html#aa0489f064ae55a20229646a584110a39">Test::verbosity</a>)</li>
</ol>
<p>The rules are as follows for each kind of possible output flag:</p>
<ol type="1">
<li>Is the flag set in TEST_MAX_VERBOSITY? If not set, then the output is suppressed and we are done.</li>
</ol>
<ol type="1">
<li>Is the flag set in <a class="el" href="class_test.html#aad3dc21628f5210b9ebdf843eb2b2ae0">Test::max_verbosity</a>? If not set, then the output is suppressed and we are done.</li>
</ol>
<ol type="1">
<li>Is the flag set in <a class="el" href="class_test.html#a1ff0e4cf27254c988233880fff9e6c6d">Test::min_verbosity</a>? If set, then the output is generated and we are done.</li>
</ol>
<ol type="1">
<li><p class="startli">Are we in a test context (<a class="el" href="class_test.html#abb64a8b970de8b2422b9f56cd8719ca4">Test::run()</a>)?</p>
<p class="startli">If so, the output is generated if the corresponding per-test verbosity flag is set.</p>
</li>
</ol>
<p>The default values are as follows</p>
<div class="fragment"><div class="line">TEST_MAX_VERBOSITY = TEST_VERBOSITY_ALL</div>
<div class="line"> </div>
<div class="line">static Test::max_verbosity = TEST_VERBOSITY_ALL</div>
<div class="line">static Test::min_verbosity = TEST_VERBOSITY_TESTS_SUMMARY</div>
<div class="line"> </div>
<div class="line">Test::verbosity = (TEST_VERBOSTY_TESTS_ALL|TEST_VERBOSITY_ASSERTIONS_FAILED)</div>
</div><!-- fragment --><p>This amounts to asking for a summary of each test (skip, pass, fail), an overall summary when all tests are resolved, and a more detailed report on each of the failed assertions. <br  />
</p>
<p>The verbosity flags are the bitwise-or of the following values</p>
<div class="fragment"><div class="line">TEST_VERBOSITY_TESTS_SUMMARY      (0x01)</div>
<div class="line">TEST_VERBOSITY_TESTS_FAILED       (0x02)</div>
<div class="line">TEST_VERBOSITY_TESTS_PASSED       (0x04)</div>
<div class="line">TEST_VERBOSITY_TESTS_SKIPPED      (0x08)</div>
<div class="line">TEST_VERBOSITY_TESTS_ALL          (0x0F)</div>
<div class="line">TEST_VERBOSITY_ASSERTIONS_FAILED  (0x10)</div>
<div class="line">TEST_VERBOSITY_ASSERTIONS_PASSED  (0x20)</div>
<div class="line">TEST_VERBOSITY_ASSERTIONS_ALL     (0x30)</div>
<div class="line">TEST_VERBOSITY_ALL                (0x3F)</div>
<div class="line">TEST_VERBOSITY_NONE               (0x00)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md82"></a>
Built-in Assertions (details)</h2>
<p>The following assertions are supported</p>
<div class="fragment"><div class="line">assertLess(arg1,arg2)</div>
<div class="line">assertLessOrEqual(arg1,arg2)</div>
<div class="line">assertEqual(arg1,arg2)</div>
<div class="line">assertNotEqual(arg1,arg2)</div>
<div class="line">assertMoreOrEqual(arg1,arg2)</div>
<div class="line">assertMore(arg1,arg2)</div>
</div><!-- fragment --><p> Anything that can be compared via a '&lt;' comparison between them can be used.</p>
<p>All the string-like types (<a class="el" href="class_string.html">String</a>, char *, char[] and flash string literals) can be used interchangeably in assertions, i.e.: </p><div class="fragment"><div class="line">test(strings) {</div>
<div class="line">   const char *cOk=&quot;ok&quot;;</div>
<div class="line">   char aOk[3]; </div>
<div class="line">   String sOk(cOk);</div>
<div class="line">   // two underbars (_) for a flash string literal...</div>
<div class="line">   const __FlashStringHelper *fOk = F(&quot;ok&quot;); </div>
<div class="line"> </div>
<div class="line">   strcpy(aOk,cOk);</div>
<div class="line"> </div>
<div class="line">   assertEqual(cOk,aOk,F(&quot;char* vs char[]&quot;));</div>
<div class="line">   assertEqual(aOk,sOk,F(&quot;char[] vs String&quot;));</div>
<div class="line">   assertEqual(sOk,fOk,F(&quot;String vs flash&quot;));</div>
<div class="line">   assertEqual(fOk,cOk,F(&quot;flash vs char*&quot;));   </div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md83"></a>
__FlashStringHelper ?</h3>
<p>Note that using a flash string literal directly (except the footnote) in an assert is not supported. You must declare and use them separately as above. The main reason for this is the F() macro expands to a large useless expression, which is then represented in flash as part of the assert message. The alternate version keeps the assert message small and readable.</p>
<p>There are addtionally some boolean assertions: </p><div class="fragment"><div class="line">assertTrue(arg)</div>
<div class="line">assertFalse(arg)</div>
</div><!-- fragment --><p> These are shorthands for <code><a class="el" href="_arduino_unit_8h.html#ae8e6d12a4e06720b114bf6ad446e646b">assertEqual(arg,true)</a></code> and <code><a class="el" href="_arduino_unit_8h.html#ae8e6d12a4e06720b114bf6ad446e646b">assertEqual(arg,false)</a></code>.</p>
<p>See the section below for assertions on tests.</p>
<p>The output from these assertions is to print a string represenation of the arguments, and the value of the arguments, as in: </p><div class="fragment"><div class="line">Assertion passed/failed: (arg1=value1) op (arg2=value2), file name, line #.</div>
</div><!-- fragment --><p> These assertions are defined in a way that the problem of multiple evaluations is avoided. The arguments are only evaluated once in these assertions. <br  />
</p>
<p>All the assert macros expand to a test that creates an optional message, and, if false, calls fail() on the current test and returns.</p>
<h2><a class="anchor" id="autotoc_md84"></a>
Meta Assertions (Advanced)</h2>
<p>You can make assertions on the outcome of tests as well. The following meta-assertions are supported:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Meta Assertion   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#a25a2bbc1617d261cd7acc36e374a94ac">assertTestDone(test [,footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone">test done (skip, pass or fail)?    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#a2faee5dc7109fcf4a8e3a266adcdaf90">assertTestNotDone(test [,footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone">test not done?    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#a1bc0ce470d9c22b67c33b0b5d64b26af">assertTestPass(test [,footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone">test passed?    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#a7f9b938ed02b499fde6907f70d520bb0">assertTestNotPass(test [,footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone">test not passed (fail, skip, or not done)?    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#a049f9d2ca0733ec8f639366382a624f6">assertTestFail(test [,footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone">test failed?    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#a8028cdca4a5abe06cc98430a1374e7ca">assertTestNotFail(test [,footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone">test not failed (pass, skip, or not done)?    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#a0f64de830a39d2402bc70e5535e11ff2">assertTestSkip(test [,footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone">test skipped?    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#a7d66e8a625e77a3a2e1f03d0b31defbb">assertTestNotSkip(test [,footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone">test not skipped (pass, fail, or not done)?   </td></tr>
</table>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Meta Assertion   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#a3a4b329fe28e54017ba9825941ae6175">assertCurrentTestDone([footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone">current test done (skip, pass or fail)?    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#a91276fe5214b645bc0b98c5d2bb8b4d6">assertCurrentTestNotDone([footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone">current test not done?    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#a88bdff8a26ea71b035cba33b840b5c82">assertCurrentTestPass([footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone">current test passed?    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#aa3eadd5703a01b0cf9a2a383eb5979ab">assertCurrentTestNotPass([footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone">current test not passed (fail, skip, or not done)?    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#a70db1d7d978b1664cd200df284869678">assertCurrentTestFail([footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone">current test failed?    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#a90d4a840196a839504cc3621926bdd61">assertCurrentTestNotFail([footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone">current test not failed (pass, skip, or not done)?    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#a19ffa2238528bac7b6a54427a4339b89">assertCurrentTestSkip([footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone">current test skipped?    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="_arduino_unit_8h.html#a61bd7512aa733a13f535675162687e20">assertCurrentTestNotSkip([footnote[,retval]])</a></code>   </td><td class="markdownTableBodyNone">current test not skipped (pass, fail, or not done)?   </td></tr>
</table>
<p>These can be used in conjunction with the boolean check-only macros </p><div class="fragment"><div class="line">checkTestDone(test) / checkCurrentTestDone()</div>
<div class="line">checkTestNotDone(test) / checkCurrentTestNotDone()</div>
<div class="line">checkTestPass(test) / checkCurrentTestPass()</div>
<div class="line">checkTestNotPass(test) / checkCurrentTestNotPass()</div>
<div class="line">checkTestFail(test) / checkCurrentTestFail()</div>
<div class="line">checkTestNotFail(test) / checkCurrentTestNotFail()</div>
<div class="line">checkTestSkip(test) / checkCurrentTestSkip()</div>
<div class="line">checkTestNotSkip(test) / checkCurrentTestNotSkip()</div>
</div><!-- fragment --><p>These behave like the other asserts, but they work only in the context of other tests. The most likely place you would have such a test would be in a testing meta-test as so:</p>
<div class="fragment"><div class="line">test(ok) { pass(); }</div>
<div class="line">test(bad) { fail(); }</div>
<div class="line">testing(slow) { if (millis() &gt; 1000) pass(); }</div>
<div class="line"> </div>
<div class="line">testing(passed) </div>
<div class="line">{</div>
<div class="line">  if (checkTestDone(ok)) {</div>
<div class="line">    assertTestPass(ok);</div>
<div class="line">    pass();</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">testing(too_slow)</div>
<div class="line">{</div>
<div class="line">  if (millis() &gt; 100) {</div>
<div class="line">    assertTestDone(slow);</div>
<div class="line">    pass();</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md85"></a>
&lt;tt&gt;Test&lt;/tt&gt; and &lt;tt&gt;TestOnce&lt;/tt&gt; (advanced)</h2>
<p>You can create your own modular tests by deriving from these classes.</p>
<div class="fragment"><div class="line">class MyTest : public Test {</div>
<div class="line">private:</div>
<div class="line">  void construct() {</div>
<div class="line">    // TODO: construct named test.</div>
<div class="line">    // This should be lightweight - it may be excluded</div>
<div class="line">    //</div>
<div class="line">    // You can set verbosity.</div>
<div class="line">  }</div>
<div class="line">public:</div>
<div class="line">  MyTest(const char *name) : Test(name) {construct();}</div>
<div class="line">#if defined(F)</div>
<div class="line">  MyTest(const __FlashStringHelper *name) {construct();}</div>
<div class="line">#endif</div>
<div class="line">  void setup() {</div>
<div class="line">    // TODO: setup test</div>
<div class="line">    // You can call pass(), fail(), or skip() to immediately resolve test</div>
<div class="line">    // You can make assertions.</div>
<div class="line">    // You can set verbosity.</div>
<div class="line">  }</div>
<div class="line">  void loop() {</div>
<div class="line">    // TODO: run test on each loop</div>
<div class="line">    // You can call pass(), fail(), or skip() to resolve test</div>
<div class="line">    // You can make assertions.</div>
<div class="line">    // You can set verbosity.</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">class MyTestOnce : public TestOnce</div>
<div class="line">{</div>
<div class="line">public:</div>
<div class="line">  MyTestOnce(const char *name) : TestOnce(name) {</div>
<div class="line">  // same as MyTest</div>
<div class="line">  }</div>
<div class="line">  void setup() {</div>
<div class="line">  // same as MyTest</div>
<div class="line">  }</div>
<div class="line">  void once() {</div>
<div class="line">  // same as MyTest::loop(), but will only be called once from loop()</div>
<div class="line">  // if included in the active tests and was not resolved in setup().</div>
<div class="line">  }  </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">// create instances of the custom test </div>
<div class="line">MyTest myTest1(F(&quot;myTest1&quot;));</div>
<div class="line">MyTest myTest2(F(&quot;myTest2&quot;));</div>
<div class="line"> </div>
<div class="line">MyTestOnce myTestOnce1(&quot;myTestOnce1&quot;);</div>
<div class="line">MyTestOnce myTestOnce2(&quot;myTestOnce2&quot;);</div>
</div><!-- fragment --><p>Note that <code><a class="el" href="class_test.html#abb64a8b970de8b2422b9f56cd8719ca4">Test::run()</a></code> only calls the active unresolved tests.</p>
<h2><a class="anchor" id="autotoc_md86"></a>
Known Bugs</h2>
<ul>
<li>The <code>assertCurrentTestXXXX([,footnote [,retval])</code> macros do not compile on ESP8266 boards with no footnote. Use an empty footnote <code>assertCurrentTestXXXX("")</code>, or use <code>assertCurrentTestXXXX_0()</code> for no footnote. You do not have to specify a return value.</li>
</ul>
<h2><a class="anchor" id="autotoc_md87"></a>
FAQ</h2>
<p>Q. The line number of the asserts do not match the source file.</p>
<p>A. As far as I can tell, this is a bug in the compiler &ndash; look two lines up. I do not know why the <code>__LINE__</code> macro does not match the actual line of code.</p>
<p>Q. What's with the <code># 2 "file.ino"</code> business in the examples?</p>
<p>A. This is to address question 1 above, and, without this line, the filename will be a very long and mostly useless name in the asserts, like,</p>
<pre>
/var/folders/gr/n9s7qtcs2qqbdnmcgm6gjzrm0000gp/T/build2118014134542174575.tmp/sketch_mar17a.ino
</pre><p>This uses up flash memory space and doesn't give any useful information when something goes wrong.</p>
<p>Q. I get these link errors about multiply defined test_XXXX_instance.</p>
<p>A. You have defined two tests with the same name XXXX using either the <a class="el" href="_arduino_unit_8h.html#a191e80e8763446a0e725a8e58fb3380b">test()</a> or <a class="el" href="_arduino_unit_8h.html#ae8c6ee99d95c8b788bf896974172a7e5">testing()</a> macro.</p>
<p>Q. I get no output</p>
<p>A. Here is a troubleshooting guideline:</p>
<ul>
<li>Make sure you call <code>Serial.begin()</code> in your setup. Or, if you redirect output by changing the value of <code><a class="el" href="class_test.html#a33e59751992ec1a8a65745c0b6b144b0">Test::out</a></code>, make sure you configure the <a class="el" href="class_print.html">Print</a> stream you direct it to.</li>
<li>If you are using an Arduino Leonardo/Micro: don't forget to add <code>while(!Serial) {}</code> after <code>Serial.begin(9600)</code> in the setup(). Without this line nothing will be printed in the serial monitor.</li>
<li>Make sure you call <code><a class="el" href="class_test.html#abb64a8b970de8b2422b9f56cd8719ca4">Test::run()</a></code> in your loop().</li>
<li>Make sure you did not exclude the <a class="el" href="_arduino_unit_8h.html#a191e80e8763446a0e725a8e58fb3380b">test(s)</a> with <code>Test::exclude(pattern)</code>. By default all tests are included.</li>
<li>Make sure your tests complete.<ul>
<li>Each single-check <a class="el" href="_arduino_unit_8h.html#a191e80e8763446a0e725a8e58fb3380b">test()</a> test not be in an infinite loop.</li>
<li>Each continous <a class="el" href="_arduino_unit_8h.html#ae8c6ee99d95c8b788bf896974172a7e5">testing()</a> test do a small amount of work on each call, and should eventually invoke pass(), fail() or skip().</li>
</ul>
</li>
<li>Make sure verbosity is adequate. You can generate all possible output by<ul>
<li>Assuring that TEST_MAX_VERBOSITY in <a class="el" href="_arduino_unit_8h.html">ArduinoUnit.h</a> is TEST_VERBOSITY_ALL (the default).</li>
<li>Assuring that <a class="el" href="class_test.html#aad3dc21628f5210b9ebdf843eb2b2ae0">Test::max_verbosity</a> is TEST_VERBOSITY_ALL (the default).</li>
<li>Setting <a class="el" href="class_test.html#a1ff0e4cf27254c988233880fff9e6c6d">Test::min_verbosity</a> = TEST_VERBOSITY_ALL (the default is TEST_VERBOSITY_TESTS_ALL | TEST_VERBOSITY_ASSERTIONS_FAILED, generating output only for failed assertions, completions of tests, and an overall summary).</li>
<li>With these settings, the per-test verbosity has no effect. </li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
